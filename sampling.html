<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="设计与抽样 - 学习实验设计、抽样方法、数据收集，获取高质量的可靠数据">
  <title>设计与抽样 - 统计学学习平台</title>
  <link rel="stylesheet" href="assets/bootstrap-custom.css">
  <link rel="stylesheet" href="assets/katex-custom.css">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="main-content">
    <div class="sampling-page">
      <h1 class="page-title">设计与抽样</h1>

      <div class="content-card">
        <h2 class="card-title">📋 什么是设计与抽样？</h2>
        <p>
          统计学研究的第一步是获取高质量的数据。设计与抽样关注如何科学地收集数据，包括实验设计、抽样方法、问卷设计等。
          好的设计和抽样是统计推断可靠性的基础——"垃圾进，垃圾出"。
        </p>
      </div>

      <div class="content-card">
        <h2 class="card-title">🎯 实验设计</h2>

        <h3 class="mt-4 mb-3">1. 实验设计的三大原则</h3>

        <div class="mb-4">
          <h4>随机化 (Randomization)</h4>
          <p>随机分配实验对象到不同处理组，消除系统性偏差。</p>
          <p class="text-muted"><strong>应用：</strong>药物临床试验、A/B测试、教育干预研究</p>
        </div>

        <div class="mb-4">
          <h4>重复 (Replication)</h4>
          <p>在相同条件下重复实验多次，提高结果的可靠性。</p>
          <p class="text-muted"><strong>应用：</strong>科学实验验证、产品质量检测、市场调研</p>
        </div>

        <div class="mb-4">
          <h4>区组 (Blocking)</h4>
          <p>将相似的对象分组，减少组内变异，提高实验效率。</p>
          <p class="text-muted"><strong>应用：</strong>农业试验（按土壤类型分组）、医学研究（按年龄分组）</p>
        </div>

        <h3 class="mt-4 mb-3">2. 实验类型</h3>

        <div class="mb-4">
          <h4>完全随机设计</h4>
          <p>将实验对象随机分配到各个处理组，适用于同质总体。</p>
          <div class="formula-box">
            <span class="katex katex-display">H<sub class="katex-subscript">0</sub>: <span class="katex-symbol">μ</span><sub class="katex-subscript">1</sub> = <span class="katex-symbol">μ</span><sub class="katex-subscript">2</sub> = \cdots = <span class="katex-symbol">μ</span><sub class="katex-subscript">k</sub></span>
          </div>
          <p class="text-muted"><strong>应用：</strong>简单药物测试、教学方法比较</p>
        </div>

        <div class="mb-4">
          <h4>随机区组设计</h4>
          <p>先将对象按某种特征分组（区组），然后在每组内随机分配处理。</p>
          <p class="text-muted"><strong>应用：</strong>不同土壤条件下的作物试验、不同年龄组的药物测试</p>
        </div>

        <div class="mb-4">
          <h4>析因设计</h4>
          <p>同时研究多个因素及其交互作用。</p>
          <div class="formula-box">
            <span class="katex katex-display">Y = <span class="katex-symbol">μ</span> + <span class="katex-symbol">α</span><sub class="katex-subscript">i</sub> + <span class="katex-symbol">β</span><sub class="katex-subscript">j</sub> + (<span class="katex-symbol">α</span><span class="katex-symbol">β</span>)<sub class="katex-subscript">ij</sub> + \varepsilon<sub class="katex-subscript">ijk</sub></span>
          </div>
          <p class="text-muted"><strong>应用：</strong>多因素工艺优化、营销活动效果分析</p>
        </div>
      </div>

      <div class="content-card">
        <h2 class="card-title">🎲 抽样方法</h2>

        <h3 class="mt-4 mb-3">1. 概率抽样</h3>

        <div class="mb-4">
          <h4>简单随机抽样 (SRS)</h4>
          <p>总体中每个个体被抽中的概率相同。</p>
          <div class="formula-box">
            <span class="katex katex-display">P(<span class="katex-text">个体</span>i <span class="katex-text">被选中</span>) = <span class="katex-fraction"><span class="katex-numerator">n</span><span class="katex-denominator">N</span></span></span>
          </div>
          <p class="text-muted">其中 N 是总体大小，n 是样本大小。</p>
          <p class="text-muted"><strong>应用：</strong>彩票抽奖、小型调查、质量抽检</p>
        </div>

        <div class="mb-4">
          <h4>分层抽样</h4>
          <p>先将总体分成若干层，然后在每层内进行独立抽样。</p>
          <div class="formula-box">
            <span class="katex katex-display"><span class="katex-symbol">ȳ</span><sub class="katex-subscript">str</sub> = <span class="katex-op">∑</span><sub class="katex-subscript">h=1</sub><sup class="katex-superscript">H</sup> <span class="katex-fraction"><span class="katex-numerator">N<sub class="katex-subscript">h</sub></span><span class="katex-denominator">N</span></span> <span class="katex-symbol">ȳ</span><sub class="katex-subscript">h</sub></span>
          </div>
          <p class="text-muted">其中 H 是层数，<span class="katex katex-inline">N<sub class="katex-subscript">h</sub></span> 是第 h 层的大小，<span class="katex katex-inline"><span class="katex-symbol">ȳ</span><sub class="katex-subscript">h</sub></span> 是第 h 层的样本均值。</p>
          <p class="text-muted"><strong>应用：</strong>全国性调查（按地区分层）、收入调查（按收入分层）</p>
        </div>

        <div class="mb-4">
          <h4>系统抽样</h4>
          <p>按照固定间隔从总体中抽取样本。</p>
          <p class="text-muted"><strong>步骤：</strong></p>
          <ol>
            <li>确定抽样间隔 k = N/n</li>
            <li>在 1 到 k 之间随机选择一个起始点 r</li>
            <li>抽取 r, r+k, r+2k, ..., r+(n-1)k</li>
          </ol>
          <p class="text-muted"><strong>应用：</strong>生产线质量检测、档案抽样、时间序列抽样</p>
        </div>

        <div class="mb-4">
          <h4>整群抽样</h4>
          <p>先将总体分成若干群，随机抽取若干群，对抽中的群进行全面调查。</p>
          <p class="text-muted"><strong>优点：</strong>实施方便、成本低</p>
          <p class="text-muted"><strong>缺点：</strong>群内相似性高时效率低</p>
          <p class="text-muted"><strong>应用：</strong>学校调查（以班级为单位）、社区调查（以社区为单位）</p>
        </div>

        <div class="mb-4">
          <h4>多阶段抽样</h4>
          <p>结合多种抽样方法，分阶段进行抽样。</p>
          <p class="text-muted"><strong>示例：</strong>全国调查 → 省 → 市 → 区 → 街道 → 家庭</p>
          <p class="text-muted"><strong>应用：</strong>大规模人口普查、国家级调查</p>
        </div>

        <h3 class="mt-4 mb-3">2. 非概率抽样</h3>

        <div class="mb-4">
          <h4>方便抽样</h4>
          <p>选择最容易获得的样本。</p>
          <p class="text-muted"><strong>应用：</strong>初步探索、试点研究</p>
        </div>

        <div class="mb-4">
          <h4>配额抽样</h4>
          <p>按比例从不同群体中抽取样本。</p>
          <p class="text-muted"><strong>应用：</strong>市场调研、民意调查</p>
        </div>

        <div class="mb-4">
          <h4>雪球抽样</h4>
          <p>通过已有样本介绍新的样本。</p>
          <p class="text-muted"><strong>应用：</strong>特殊群体研究（如罕见病患者、地下经济）</p>
        </div>
      </div>

      <div class="content-card">
        <h2 class="card-title">📊 样本量确定</h2>

        <h3 class="mt-4 mb-3">1. 估计均值时的样本量</h3>
        <div class="formula-box">
          <span class="katex katex-display">n = <span class="katex-fraction"><span class="katex-numerator">Z<sup class="katex-superscript">2</sup> <span class="katex-symbol">σ</span><sup class="katex-superscript">2</sup></span><span class="katex-denominator">E<sup class="katex-superscript">2</sup></span></span></span>
        </div>
        <p class="text-muted">其中：</p>
        <ul>
          <li>Z - 标准正态分布的临界值（如 95% 置信水平下 Z=1.96）</li>
          <li>σ - 总体标准差（通常用预调查估计）</li>
          <li>E - 允许的边际误差</li>
        </ul>

        <h3 class="mt-4 mb-3">2. 估计比例时的样本量</h3>
        <div class="formula-box">
          <span class="katex katex-display">n = <span class="katex-fraction"><span class="katex-numerator">Z<sup class="katex-superscript">2</sup> p(1-p)</span><span class="katex-denominator">E<sup class="katex-superscript">2</sup></span></span></span>
        </div>
        <p class="text-muted">其中 p 是总体比例（未知时用 p=0.5 使样本量最大）。</p>

        <h3 class="mt-4 mb-3">3. 假设检验时的样本量</h3>
        <div class="formula-box">
          <span class="katex katex-display">n = <span class="katex-fraction"><span class="katex-numerator">(Z_<span class="katex-symbol">α</span> + Z_<span class="katex-symbol">β</span>)<sup class="katex-superscript">2</sup> <span class="katex-symbol">σ</span><sup class="katex-superscript">2</sup></span><span class="katex-denominator"><span class="katex-symbol">Δ</span><sup class="katex-superscript">2</sup></span></span></span>
        </div>
        <p class="text-muted">其中：</p>
        <ul>
          <li><span class="katex katex-inline">Z_<span class="katex-symbol">α</span></span> - 第一类错误的临界值</li>
          <li><span class="katex katex-inline">Z_<span class="katex-symbol">β</span></span> - 第二类错误的临界值</li>
          <li>Δ - 要检测的差异大小</li>
        </ul>
      </div>

      <div class="content-card">
        <h2 class="card-title">📋 问卷设计</h2>

        <h3 class="mt-4 mb-3">1. 问卷设计原则</h3>
        <ul>
          <li><strong>明确目的：</strong>每个问题都应有明确的调查目的</li>
          <li><strong>避免引导性：</strong>问题不应暗示答案</li>
          <li><strong>语言清晰：</strong>使用简单、无歧义的语言</li>
          <li><strong>逻辑顺序：</strong>从一般到具体，从易到难</li>
          <li><strong>适当长度：</strong>避免问卷过长导致疲劳</li>
        </ul>

        <h3 class="mt-4 mb-3">2. 问题类型</h3>

        <div class="mb-4">
          <h4>开放式问题</h4>
          <p>允许受访者自由回答。</p>
          <p class="text-muted"><strong>优点：</strong>信息丰富、灵活</p>
          <p class="text-muted"><strong>缺点：</strong>难以编码、分析复杂</p>
        </div>

        <div class="mb-4">
          <h4>封闭式问题</h4>
          <p>提供固定选项供选择。</p>
          <p class="text-muted"><strong>类型：</strong>单选题、多选题、量表题</p>
          <p class="text-muted"><strong>优点：</strong>易于编码、分析方便</p>
          <p class="text-muted"><strong>缺点：</strong>限制回答范围</p>
        </div>

        <h3 class="mt-4 mb-3">3. 常见偏差</h3>
        <ul>
          <li><strong>社会期许偏差：</strong>受访者倾向于给出"社会认可"的答案</li>
          <li><strong>回忆偏差：</strong>受访者难以准确回忆过去的事件</li>
          <li><strong>默认选项偏差：</strong>倾向于选择第一个或默认选项</li>
          <li><strong>顺序效应：</strong>问题的顺序影响回答</li>
        </ul>
      </div>

      <div class="content-card">
        <h2 class="card-title">🧮 交互式计算器</h2>
        <p>计算所需的样本量：</p>

        <div class="mb-3">
          <label class="form-label">计算类型：</label>
          <select class="form-select" id="sampleSizeType" onchange="toggleSampleSizeInputs()">
            <option value="mean">估计均值</option>
            <option value="proportion">估计比例</option>
          </select>
        </div>

        <div class="row">
          <div class="col-md-6 mb-3">
            <label class="form-label">置信水平：</label>
            <select class="form-select" id="confidenceLevel">
              <option value="90">90%</option>
              <option value="95" selected>95%</option>
              <option value="99">99%</option>
            </select>
          </div>
          <div class="col-md-6 mb-3">
            <label class="form-label">边际误差 (E)：</label>
            <input type="number" step="any" class="form-control" id="marginError" placeholder="例如：5" />
          </div>
        </div>

        <div id="meanInputs">
          <div class="mb-3">
            <label class="form-label">总体标准差 (σ)：</label>
            <input type="number" step="any" class="form-control" id="populationStd" placeholder="例如：10" />
          </div>
        </div>

        <div id="proportionInputs" style="display: none;">
          <div class="mb-3">
            <label class="form-label">总体比例 (p)：</label>
            <input type="number" step="0.01" class="form-control" id="populationProportion" placeholder="未知时留空，默认0.5" />
          </div>
        </div>

        <button class="btn btn-custom btn-primary-custom" onclick="calculateSampleSize()">
          计算样本量
        </button>

        <div id="sampleSizeResult" class="mt-4" style="display: none;">
          <div class="content-card" style="background: rgba(33, 150, 243, 0.1);">
            <h4 class="text-center mb-3">建议样本量</h4>
            <h2 class="text-center" id="requiredSampleSize"></h2>
            <p class="text-center text-muted" id="sampleSizeExplanation"></p>
          </div>
        </div>
      </div>

      <div class="content-card">
        <h2 class="card-title">💡 实际应用</h2>
        <ul class="feature-list">
          <li>
            <div class="feature-icon icon-blue">🏥</div>
            <div>
              <strong>临床试验：</strong> 随机对照试验、双盲设计、安慰剂对照
            </div>
          </li>
          <li>
            <div class="feature-icon icon-pink">🏭</div>
            <div>
              <strong>质量控制：</strong> 抽样检验、质量控制图、六西格玛
            </div>
          </li>
          <li>
            <div class="feature-icon icon-green">📊</div>
            <div>
              <strong>市场调研：</strong> 目标群体抽样、问卷设计、消费者洞察
            </div>
          </li>
          <li>
            <div class="feature-icon icon-blue">🔬</div>
            <div>
              <strong>社会科学：</strong> 调查研究、实验设计、政策评估
            </div>
          </li>
        </ul>
      </div>

      <div class="content-card">
        <h2 class="card-title">⚠️ 常见问题</h2>

        <div class="mb-4">
          <h4>抽样误差 vs 非抽样误差</h4>
          <p><strong>抽样误差：</strong>由于只抽取部分样本而产生的随机误差，可以通过增加样本量减少。</p>
          <p><strong>非抽样误差：</strong>包括覆盖误差、无响应误差、测量误差等，与样本量无关。</p>
        </div>

        <div class="mb-4">
          <h4>无响应处理</h4>
          <ul>
            <li>提高响应率（多次联系、激励机制）</li>
            <li>加权调整（根据无响应特征调整权重）</li>
            <li>替代抽样（用相似样本替代）</li>
          </ul>
        </div>

        <div class="mb-4">
          <h4>数据质量评估</h4>
          <ul>
            <li>检查缺失值和异常值</li>
            <li>评估无响应偏差</li>
            <li>验证数据一致性</li>
            <li>进行预调查测试问卷</li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <script src="assets/bootstrap-custom.js"></script>
  <script src="assets/katex-custom.js"></script>
  <script>
    function toggleSampleSizeInputs() {
      const type = document.getElementById('sampleSizeType').value;
      if (type === 'mean') {
        document.getElementById('meanInputs').style.display = 'block';
        document.getElementById('proportionInputs').style.display = 'none';
      } else {
        document.getElementById('meanInputs').style.display = 'none';
        document.getElementById('proportionInputs').style.display = 'block';
      }
    }

    function calculateSampleSize() {
      const type = document.getElementById('sampleSizeType').value;
      const cl = parseFloat(document.getElementById('confidenceLevel').value);
      const E = parseFloat(document.getElementById('marginError').value);

      const zValues = { 90: 1.645, 95: 1.96, 99: 2.576 };
      const Z = zValues[cl];

      let n;

      if (type === 'mean') {
        const sigma = parseFloat(document.getElementById('populationStd').value);
        if (isNaN(sigma) || sigma <= 0) {
          alert('请输入有效的总体标准差');
          return;
        }
        n = Math.ceil((Z * Z * sigma * sigma) / (E * E));
        document.getElementById('sampleSizeExplanation').textContent = 
          `在 <span class="katex katex-inline">{cl}% 置信水平下，要使估计均值的误差不超过 ±</span>{E}，需要 <span class="katex katex-inline">{n} 个样本。`;
      } else {
        const pInput = document.getElementById('populationProportion').value;
        const p = pInput === '' ? 0.5 : parseFloat(pInput);
        if (p < 0 || p > 1) {
          alert('比例必须在 0 到 1 之间');
          return;
        }
        n = Math.ceil((Z * Z * p * (1 - p)) / (E * E));
        document.getElementById('sampleSizeExplanation').textContent = 
          `在 </span>{cl}% 置信水平下，要使估计比例的误差不超过 ±<span class="katex katex-inline">{E}%，需要 </span>{n} 个样本。`;
      }

      document.getElementById('requiredSampleSize').textContent = n;
      document.getElementById('sampleSizeResult').style.display = 'block';
    }

    document.addEventListener("DOMContentLoaded", function() {
      renderMathInElement(document.body, {
        delimiters: [
          {left: '<span class="katex katex-display">', right: '</span>', display: true},
          {left: '<span class="katex katex-inline">', right: '</span>', display: false}
        ]
      });
    });
  </script>
</body>
</html>